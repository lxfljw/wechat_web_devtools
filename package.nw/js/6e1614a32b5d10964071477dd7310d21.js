'use strict';!function(require,directRequire){function a(a,j={}){return new Promise(async(l,o)=>{const p=await g(a),q=p.srcPath;let r=p.getAllWXMLFiles();const{type:s}=j,t=p.getAllWXSFiles();t&&0<t.length&&(r=r.concat(t));let u;try{u=await h.getCompileConfig(a)}catch(a){return o(a)}r=r.map((a)=>`./${a}`);const v=`$gwx_${j.pluginId}`;if(!r||0==r.length)return l({code:'',name:v});const w='>_<'+Date.now()%1e4,x=['-d',s,u.join(w),'--split',w].concat(r).concat(['-p','-gn',v]),y=a.setting&&a.setting.newFeature,z=c.join(e.tmpdir(),k.random()),A=b(x);A&&d.writeFileSync(z,x.join('\n'));const B=f.getWXMLParsePath(y),C=n(B,A?['--config-path',k.normalizePath(z)]:x,{cwd:q}),D=[],E=[];C.on('close',(a)=>{if(A&&d.unlinkSync(z),0===a){const a=Buffer.concat(D).toString();return l({code:a,name:v})}const b=Buffer.concat(E).toString(),c=new Error(i.config.COMPILE_WXML_ERROR_CONSOLE);return c.code=m,c.msgForConsole=b,o(c)}),C.stdout.on('data',(a)=>{D.push(a)}),C.stderr.on('data',(a)=>{E.push(a)})})}function b(a){if('darwin'!==process.platform){if(128<a.length)return!0;for(const b of a)if(1e4<b.length)return!0}return!1}const c=require('path'),d=require('fs'),e=require('os'),f=require('./d28a711224425b00101635efe1034c99.js'),g=require('./a63026ab5a5a3c59a61a9749a18aa2ca.js'),h=require('./e53dfc2b83456f986002c49964f30fbf.js'),i=require('./common/locales/index.js'),j=require('./2e9637e8a0816a626f7db9a0dee5efe8.js'),k=require('./84b183688a46c9e2626d3e6f83365e13.js'),l=require('./92320c1386e6db6a6f2556736a9bc280.js'),{PLUGIN_TRANS_WXML_JS_ERR:m}=require('./949d8235c744ced2a80121e4dba34c28.js'),{spawn:n}=require('child_process');module.exports=async function(b,c={}){await j.init(b);const d=j.CACHE_KEYS.WXML_PLUGIN,e=c.cut?'-xc':'-cc';let f=j.get(d,e);return f||(f=await a(b,{pluginId:c.pluginId,version:c.version,type:c.cut?'-xc':'-cc'}),j.set(d,e,f)),f}}(require('lazyload'),require);