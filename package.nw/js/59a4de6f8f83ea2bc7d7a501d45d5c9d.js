'use strict';!function(require,directRequire){function a(a,e={}){const{srcFilePath:f,fileBuffer:g,destFilePath:i}=e,j=c.extname(f);if(n[j]){const a=l(g);if(void 0===a){const a=new Error(h.config.FILE_NOT_UTF8.format(f));throw a.code=m,a}}const k=c.dirname(i);d.sync(k),b.writeFileSync(i,g)}const b=require('fs'),c=require('path'),d=require('mkdir-p'),e=require('./162bf2ee28b76d3b3d95b685cede4146.js'),f=require('./a63026ab5a5a3c59a61a9749a18aa2ca.js'),g=require('./9fdd4ac31a05c27355910f0d74accd4c.js'),h=require('./common/locales/index.js'),i=require('./d260ebf687a29f24aed49f66b233ab7d.js'),j=require('./dedcbe3bc309c536210de2a4e997918e.js'),k=require('./551bb965e1f344281d555a429cd2140c.js'),{bufToUTF8:l}=require('./efc820e1b92d6e4063535296d4a24213.js'),{FILE_NOT_UTF8:m}=require('./949d8235c744ced2a80121e4dba34c28.js'),n={".json":!0,".wxml":!0,".wxs":!0},{whiteFileExtName:o,gameWhiteFileExtName:p}=require('./6242f55dbdfe53c2f07b7a51568311f2.js'),q={".js":!0,".wxss":!0};module.exports=async function(d,h={}){const l=d.compileType,{distPath:m}=h;let n=await e(d),r=n.getAllFile(),s=o;d.attr&&d.attr.gameApp&&(s=p);let t=l==g.plugin?d.miniprogramRoot:'';for(let b=0,e=r.length;b<e;b++){const e=r[b],f=c.extname(e);if(!q[f]&&s[f]){if('ext.json'===e){const a=await k(d);if(!a||!a.extEnable)continue}let b=n.getFile(e,null);if('.json'===f&&!(d.attr&&d.attr.gameApp)&&'app.json'!=e){const a=await i(d,e.replace(/\.json$/,''));b=new Buffer(JSON.stringify(a),'utf8')}a(d,{fileBuffer:b,srcFilePath:c.join(t,e),destFilePath:c.join(m,t,e)})}}if(l==g.plugin){n=await f(d),r=n.getAllFile(),s=o,t=d.pluginRoot,d.attr&&d.attr.gameApp&&(s=p);for(let b=0,e=r.length;b<e;b++){const e=r[b],f=c.extname(e);if(!q[f]&&s[f]){let b=n.getFile(e,null);if('.json'===f&&'plugin.json'!=e){const a=await j(d,e.replace(/\.json$/,''));b=new Buffer(JSON.stringify(a),'utf8')}a(d,{fileBuffer:b,srcFilePath:c.join(t,e),destFilePath:c.join(m,t,e)})}}b.writeFileSync(c.join(m,'project.config.json'),JSON.stringify({miniprogramRoot:d.miniprogramRoot,pluginRoot:d.pluginRoot}))}b.existsSync(c.join(m,'project.config.json'))||b.writeFileSync(c.join(m,'project.config.json'),'{}')}}(require('lazyload'),require);