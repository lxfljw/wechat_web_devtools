'use strict';!function(require,directRequire){function a(a){return a=a||global.appVersion,a+='',a=a.replace(/\./g,''),parseInt(a)}function b(a,b){if(!a&&!b)return 0;if(!a)return-1;if(!b)return 1;const c=/\d+/g,d=a.match(c),e=b.match(c);if(!d)return 1;if(!e)return-1;const f=d.map((a)=>parseInt(a)),g=e.map((a)=>parseInt(a)),h=d.length>e.length?e.length:d.length;for(let c=0;c<h;c++){if(f[c]<g[c])return-1;if(f[c]>g[c])return 1}return f.length===g.length?0:f.length<g.length?-1:1}function c(){let a=nw.App.getDataPath(),b=k.join(a,'Secure Preferences'),c=j.readFileSync(b,'utf8'),d=JSON.parse(c),{extensions:e}=d,{settings:f}=e,g=chrome.runtime.id,h=f[g];h.events=[],h.filtered_events={},j.writeFileSync(b+'_temp',JSON.stringify(d));let i=require('./d28a711224425b00101635efe1034c99.js'),l=k.join(q.WeappLog,`fixpreferences.log`);j.writeFileSync(b,JSON.stringify(d));let m=s.spawn(i.getFixpreferencesPath(),[b,`${b}_temp`,l,300],{stdio:'ignore',detached:!0});m.unref()}function d(){r&&c(),nw.App.quit()}function e(a){try{if(a=k.resolve(a),!j.existsSync(a))return;let b=j.statSync(a);if(b.isDirectory()){let b=j.readdirSync(a);if(0<b.length)for(let c=0,d=b.length;c<d;c++)e(k.join(a,b[c]));j.rmdirSync(a)}else j.unlinkSync(a)}catch(a){}}function f(a,b){try{if(a=k.resolve(a),b=k.resolve(b),!j.existsSync(a))return;if(j.existsSync(b)){let c=j.statSync(b),d=j.statSync(a);if(d.isDirectory()&&c.isDirectory()){let c=j.readdirSync(a);for(let d=0,e=c.length;d<e;d++)f(k.join(a,c[d]),k.join(b,c[d]));return void j.rmdirSync(a)}c.isDirectory()&&rmdirSync(b)}j.renameSync(a,b)}catch(a){}}function g(a){if(a=k.resolve(a),j.existsSync(a)){let b=j.statSync(a);if(b.isDirectory())return;j.unlinkSync(a)}g(k.dirname(a)),j.mkdirSync(a)}function h(a,b){if(a=k.resolve(a),b=k.resolve(b),!!j.existsSync(a)){let c=j.lstatSync(a);if(c.isDirectory()){g(b);let c=j.readdirSync(a);for(let d=0,e=c.length;d<e;d++)h(k.join(a,c[d]),k.join(b,c[d]))}else{if(j.existsSync(b)){let a=j.lstatSync(b);if(a.isDirectory()){let a=k.dirname(b),c=k.join(a,''+Math.random());for(;j.existsSync(c)||c==b;)c=k.join(a,''+Math.random());j.renameSync(b,c)}}g(k.dirname(b)),j.writeFileSync(b,j.readFileSync(a),{mode:v(c.mode)})}}}function i(a){const b=m.createHash('md5');return b.update(a),b.digest('hex')}const j=require('fs'),k=require('path'),l=require('http'),m=require('crypto'),n=require('./84858de8a097c9cf84ff2c2e3d86e2a9.js'),o=require('./72653d4b93cdd7443296229431a7aa9a.js'),q=require('./92320c1386e6db6a6f2556736a9bc280.js'),p=require('./f171257bbcaef547a3cf27266ccb0db2.js'),r='darwin'===process.platform,s=require('child_process'),t=require('./8baad0631295efb1130774c37d944951.js');var u=9973;const v=(a)=>{let b;return b='number'==typeof a?a.toString(8):a,b.substring(b.length-3)};module.exports={getAvailablePort:async function(){return t.findFreePort('127.0.0.1')},getType:function(a){return Object.prototype.toString.call(a).toLowerCase().split(' ')[1].replace(']','')},getAppConfig:function(){return{isDev:!!process.execPath.match('nw.exe')||!!process.execPath.match('nwjs.app')||!!process.execPath.match('nwjs.exe'),isBeta:!0===nw.App.manifest.beta,isGamma:!0===nw.App.manifest.gamma}},checkUpdateApp:async function(){return new Promise((b,c)=>{let e=global.appVersion,f=q.WeappApplication;if(n.forceUpdateVersion){let g=n.forceUpdateVersion;n.removeForceUpdateVersion();let h=a(g),i=a(e),l='';if(i<h)l=`当前${e}版本太旧，请正在新版本${g}...`;else if(i>h)l=`当前版本${e}存在问题, 回退至版本${g}...`;else return b();const m=r?'darwin':'x64'===process.arch?'x64':'ia32';let o=`${m}_${g.replace(/\./g,'')}.${r?'dmg':'exe'}`,p=k.join(f,o);if(j.existsSync(p)){let a=global.contentDocument.querySelector('#container');a.innerHTML=`<div class="app-up-data" style="text-align:center;margin-top: 50%; font-size: 16px;padding:20px;">${l}</div>`;let b=r?'open':o,e=r?[o]:[];try{let c=s.spawn(b,e,{detached:!0,cwd:f});c.on('close',(b)=>{0!==b&&(a.innerHTML='<div class="app-up-data" style="text-align:center;margin-top: 50%;font-size: 16px; padding:20px;">\u66F4\u65B0\u5931\u8D25\uFF0C\u8BF7\u91CD\u65B0\u542F\u52A8</div>'),setTimeout(()=>{d()},2e3)})}catch(a){setTimeout(()=>{nw.Shell.openItem(k.join(f,o)),setTimeout(()=>{d()},2e3)},200)}return c()}}b()})},openInspectWin:function(){nw.Window.open('about:blank',{show:!1,width:799,height:799},(a)=>{a.maximize(),a.window.location='chrome://inspect/#devices',a.show()})},getVersionNum:a,compareLibVersion:function(a,c){return b(a,c)},compareSemVer:b,quit:d,rmSync:e,mvSync:f,cpSync:h,mkdirSync:g,getQuery:function(a=''){a=a.replace(/^\?/,'');let b=a.split('&'),c={};for(let d,e=0,f=b.length;e<f;e++)d=(b[e]||'').split('='),c[d[0]]=decodeURIComponent(d[1]);return c},normalizePath:function(a=''){const b=k.posix.normalize(a.replace(/\\/g,'/'));return(a.startsWith('//')||a.startsWith('\\\\'))&&!b.startsWith('//')?'/'+b:b},generateMD5:i,chooseFile:async function(a){const b=global.windowMap.get('MAIN').window,c=document.createElement('input');return c.style.display='none',c.setAttribute('type','file'),a.accept&&c.setAttribute('accept',a.accept),a.multiple&&c.setAttribute('multiple','multiple'),b.document.body.appendChild(c),c.click(),new Promise((a)=>{c.addEventListener('change',(d)=>{b.document.body.removeChild(c),a({success:!0,event:d})}),c.addEventListener('cancel',(d)=>{b.document.body.removeChild(c),a({success:!1,event:d})})})},fillArray:function(b,c){if(0==c)return[];for(var d=[b];2*d.length<=c;)d=d.concat(d);return d.length<c&&(d=d.concat(d.slice(0,c-d.length))),d},random:function(){return i(Math.random()+''+Date.now())},escapeScript:function(a){return a?a.replace(/<script/g,'&lt;script').replace(/<\/script/g,'&lt;/script'):a}}}(require('lazyload'),require);