'use strict';var _extends=Object.assign||function(a){for(var b,c=1;c<arguments.length;c++)for(var d in b=arguments[c],b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d]);return a};!function(require,directRequire){function a(a,b){let c=new Error(a);throw c.code=b,c}function b(b,c){'string'!=l.getType(b)&&a(m.config.JSON_CONTENT_SHOULD_BE.format([`${c}`,'string']),w.APP_JSON_CONTENT_ERR),0<=b.indexOf('\\')&&a(m.config.JSON_SHOULD_NOT_CONTAIN.format([`${c}`,'\\']),w.APP_JSON_CONTENT_ERR),0==b.indexOf('.')&&a(m.config.JSON_SHOULD_NOT_START_WITH.format([`${c}`,'.']),w.APP_JSON_CONTENT_ERR),0==b.indexOf('/')&&a(m.config.JSON_SHOULD_NOT_START_WITH.format([`${c}`,'/']),w.APP_JSON_CONTENT_ERR)}function c(a,b){function c(b,c){return'object'==l.getType(b)?'string'==l.getType(b.provider)?'string'==l.getType(b.version)?a.compileType!=o.plugin&&'dev'==b.version?void d.push(m.config.JSON_CONTENT_SHOULD_NOT_BE.format([`${c}.version`,'dev'])+'\n'+m.config.PLEASE_CHOOSE_PLUGIN_MODE):a.compileType==o.plugin&&'dev'==b.version&&b.provider!=a.appid?void d.push(m.config.JSON_CONTENT_SHOULD_BE.format([`${c}.provider`,a.appid])):'dev'==b.version||/^[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}$/.test(b.version)||void d.push(m.config.JSON_CONTENT_SHOULD_BE.format([`${c}.version`,m.config.TRIPLE_NUMBER_DOT])):void d.push(m.config.JSON_CONTENT_SHOULD_BE.format([`${c}.version`,'string'])):void d.push(m.config.JSON_CONTENT_SHOULD_BE.format([`${c}.provider`,'string'])):void d.push(m.config.JSON_CONTENT_SHOULD_BE.format([`${c}`,'object']))}const d=[],e=b.plugins;if(!e)return d;if('object'!=l.getType(e))return d.push(m.config.JSON_CONTENT_SHOULD_BE.format(['plugins','object'])),d;const f={};for(const g in e){const a=e[g];c(a,`plugins.${g}`)&&(f[a.provider]?d.push(m.config.PLUGINS_MULTI_PROVIDER.format(a.provider)):f[a.provider]={provider:a.provider,version:a.version,alias:g})}if(b.subPackages&&b.subPackages.forEach((a,b)=>{if(a.plugins)for(const g in a.plugins){const h=a.plugins[g];(e[g]&&d.push(m.config.JSON_PLUGIN_SHOULD_NOT_IN_SUBPACKAGE.format([`plugins ${g}`,`subPackages[${b}]`])),!!c(h,`subPackages[${b}].plugins.${g}`))&&(f[h.provider]?d.push(`subPackages[${b}].plugins['${g}'].provider ${m.config.ALREADY_EXISTS}`):f[h.provider]={provider:h.provider,version:h.version,alias:h})}}),0<d.length){const a=new Error(d.join('\n'));throw a.code=w.APP_JSON_CONTENT_ERR,a}}function d(c,d,e){const f=require('./6242f55dbdfe53c2f07b7a51568311f2.js'),g=_extends({},f.setting,c.runtimeAttr&&c.runtimeAttr.setting);let h='subPackages';e.subpackages&&(h='subpackages',e.subPackages=e.subpackages,delete e.subpackages);const i=e.pages||[];let n=!1;if(e.subPackages){'array'!=l.getType(e.subPackages)&&a(m.config.JSON_CONTENT_SHOULD_BE.format([h,'array']),w.APP_JSON_CONTENT_ERR),e.subPackages.length>g.MaxSubPackageLimit&&a(m.config.EXCEED_LIMIT.format([h,g.MaxSubPackageLimit]));const c={},f={},o=[];e.subPackages.forEach((a,g)=>{if(b(a.root,`${h}[${g}].root`),a.root===r.MINI_PROGRAM_MAIN_PACKAGE_ROOT)return void o.push(m.config.JSON_CONTENT_SHOULD_NOT_BE.format([`${h}[${g}].root`,r.MINI_PROGRAM_MAIN_PACKAGE_ROOT]));if(a.name){if('string'!==l.getType(a.name))return void o.push(m.config.JSON_CONTENT_SHOULD_BE.format([`${h}[${g}].name`,'string']));if(a.name===r.MINI_PROGRAM_MAIN_PACKAGE_ROOT)return void o.push(m.config.JSON_CONTENT_SHOULD_NOT_BE.format([`${h}[${g}].name`,r.MINI_PROGRAM_MAIN_PACKAGE_ROOT]));if(f[a.name])return void o.push(m.config.JSON_SUBPACKAGE_EXIST.format([`${h}[${g}].name`]));f[a.name]=!0}if(a.root=l.normalizePath(a.root+'/'),c[a.root])return void o.push(m.config.JSON_SUBPACKAGE_EXIST.format([`${h}[${g}].root`]));if(c[a.root]=!0,!k.existsSync(j.join(d,a.root)))return void o.push(m.config.JSON_CONTENT_SHOULD_BE.format([`${h}[${g}].root`,m.config.DIRECTORY]));const p=k.statSync(j.join(d,a.root));if(!p.isDirectory())return void o.push(m.config.JSON_CONTENT_SHOULD_BE.format([`${h}[${g}].root`,m.config.DIRECTORY]));if(i.forEach((b)=>{0==b.indexOf(a.root)&&o.push(m.config.JSON_PAGE_SHOULD_NOT_IN_SUBPACKAGE.format([`pages ${b}`,`${h}[${g}]`]))}),'array'!=l.getType(a.pages))return void o.push(m.config.JSON_CONTENT_SHOULD_BE.format([`${h}[${g}].pages`,'array']));const q={};for(let c=0,f=a.pages.length;c<f;c++){const f=a.pages[c];b(f,`${h}[${g}].pages[${c}]`);const i=l.normalizePath(j.posix.join(a.root,f));if(q[i]){o.push(m.config.JSON_PAGES_REPEAT.format([`${h}[${g}]`,f]));continue}q[i]=!0,n||i!=e.entryPagePath||(n=!0),k.existsSync(j.join(d,`${i}\.wxml`))||o.push(m.config.JSON_PAGE_WXML_NOT_EXISTS.format([`${h}[${g}]`,'pages',i])),k.existsSync(j.join(d,`${i}\.js`))||o.push(m.config.JSON_PAGE_JS_NOT_EXISTS.format([`${h}[${g}]`,'pages',i]))}}),0<o.length&&a(o.join('\n'),w.APP_JSON_CONTENT_ERR),e.subPackages.forEach((a,b)=>{let c=-1;const d='/'+a.root;if(e.subPackages.forEach((a,e)=>{if(e!=b&&a.root){const b='/'+a.root;0==d.indexOf(b)&&(c=e)}}),-1!=c)return void o.push(m.config.JSON_CONTENT_SHOULD_NOT_BE.format([`${h}[${b}].root`,`${h}[${c}].root 的子目录`]))}),0<o.length&&a(o.join('\n'),w.APP_JSON_CONTENT_ERR)}return n}function e(b){if(b.preloadRule&&b.subPackages){'object'!==l.getType(b.preloadRule)&&a(m.config.JSON_CONTENT_SHOULD_BE.format(['preloadRule','object']),w.APP_JSON_CONTENT_ERR);let c=[],d=[].concat(b.pages),e={},f={};for(let a=0,c=b.subPackages.length;a<c;a++){const c=b.subPackages[a],g=c.pages.map((a)=>{return j.posix.join(c.root,a)});e[c.root]=!0,c.name&&(f[c.name]=!0),d=d.concat(g)}for(const a in b.preloadRule){if(-1===d.indexOf(a)){c.push(m.config.NOT_FOUND.format(`preloadRule['${a}'] ${m.config.PAGE_PATH}`));continue}const g=b.preloadRule[a];if(g.network){if('string'!==l.getType(g.network)){c.push(m.config.JSON_CONTENT_SHOULD_BE.format([`preloadRule['${a}'].network`,'string']));continue}if(-1===['all','wifi'].indexOf(g.network)){c.push(m.config.JSON_CONTENT_SHOULD_BE.format([`preloadRule['${a}'].network`,'all/wifi']));continue}}if('array'!==l.getType(g.packages)){c.push(m.config.JSON_CONTENT_SHOULD_BE.format([`preloadRule['${a}'].packages`,'array']));continue}for(let b,d=0,h=g.packages.length;d<h;d++)if((b=g.packages[d],b!==r.MINI_PROGRAM_MAIN_PACKAGE_ROOT)&&!f[b]&&(b=l.normalizePath(b+'/'),!e[b])){c.push(m.config.NOT_FOUND.format(`preloadRule['${a}'].packages[${d}]: ${b}`));continue}}0<c.length&&a(c.join('\n'),w.APP_JSON_CONTENT_ERR)}}async function f(c,d){const e=await p(c),f=e.srcPath,g=require('./6242f55dbdfe53c2f07b7a51568311f2.js'),h=_extends({},g.setting,c.runtimeAttr&&c.runtimeAttr.setting),n=d.pages,o=d.tabBar;let q=[];if(o){'array'!=l.getType(o.list)&&a(m.config.JSON_TABBAR_SHOULD_BE_LIST,w.APP_JSON_CONTENT_ERR),o.list.length<h.MinTabbarCount&&a(m.config.JSON_TABBAR_AT_LEAST.format(h.MinTabbarCount),w.APP_JSON_CONTENT_ERR),o.list.length>h.MaxTabbarCount&&a(m.config.JSON_TABBAR_AT_MOST.format(h.MaxTabbarCount),w.APP_JSON_CONTENT_ERR);for(var r=0;r<o.list.length;r++){let a=o.list[r];if('object'!=l.getType(a)){q.push(m.config.JSON_TABBAR_ITEM_OBJECT.format(r));continue}const c=a.pagePath;if(b(c,`tabBar[${r}].pagePath`),!c){q.push(m.config.JSON_TABBAR_PATH_EMPTY.format(r));continue}if(0>n.indexOf(c)){q.push(`tabBar[${r}].pagePath "${c}" 需在 pages 数组中`);continue}2<=c.split('?').length&&q.push(m.config.JSON_TABBAR_PATH_NOT_CONTAIN.format([r,'?'])),2<=c.split('.').length&&q.push(m.config.JSON_TABBAR_PATH_NOT_CONTAIN.format([r,'.']));let d=[];if(a.iconPath){let b=j.join(f,a.iconPath);a.iconPath=j.relative(f,b),d.push({name:'iconPath',path:b})}if(a.selectedIconPath){let b=j.join(f,a.selectedIconPath);a.selectedIconPath=j.relative(f,b),d.push({name:'selectedIconPath',path:b})}d.forEach((a)=>{if(!k.existsSync(a.path))return q.push(m.config.JSON_TABBAR_ICON_NOT_FOUND.format([r,a.name]));let b=k.statSync(a.path);if(b.isDirectory())return q.push(m.config.JSON_TABBAR_ICON_NOT_DIR.format([r,a.name]));b.size>1024*h.MaxTabbarIconSize&&q.push(m.config.JSON_TABBAR_ICON_MAX_SIZE.format([r,a.name,h.MaxTabbarIconSize]));let c=j.extname(a.path);0>v.indexOf(c)&&q.push(m.config.JSON_TABBAR_ICON_EXT.format([r,a.name,v.join('\u3001')]))})}}0<q.length&&a(q.join('\n'),w.APP_JSON_CONTENT_ERR)}function g(b,c){const d=[];if(c.navigateToMiniProgramAppIdList){'array'!==l.getType(c.navigateToMiniProgramAppIdList)&&a(m.config.JSON_CONTENT_SHOULD_BE.format([`navigateToMiniProgramAppIdList`,'array'])),c.navigateToMiniProgramAppIdList.forEach((a,b)=>{'string'!==l.getType(a)&&d.push(m.config.JSON_CONTENT_SHOULD_BE.format([`navigateToMiniProgramAppIdList[${b}]`,'string']))});const e=b.runtimeAttr&&b.runtimeAttr.appType||u.APP_TYPE.NORMAL;if(e!==u.APP_TYPE.NATIVE){const a=b.runtimeAttr&&b.runtimeAttr.setting&&b.runtimeAttr.setting.NavigateMiniprogramLimit||u.setting.NavigateMiniprogramLimit;c.navigateToMiniProgramAppIdList.length>a&&d.push(m.config.EXCEED_LIMIT.format([`navigateToMiniProgramAppIdList`,a]))}}0<d.length&&a(d.join('\n'),w.APP_JSON_CONTENT_ERR)}function h(c,d){const{workers:e}=d;if(e){b(e,'workers');const d=j.join(c,e);k.existsSync(d)||a(m.config.JSON_CONTENT_SHOULD_BE.format([`workers`,m.config.DIRECTORY]));const f=k.statSync(d);f.isDirectory()||a(m.config.JSON_CONTENT_SHOULD_BE.format([`workers`,m.config.DIRECTORY]))}}async function i(i){const q=await p(i),r=q.srcPath,u=require('./6242f55dbdfe53c2f07b7a51568311f2.js'),v='app.json';let x='',y=[];try{x=q.getFile(v)}catch(a){const b=new Error(m.config.FILE_NOT_FOUND.format(v));throw b.code=w.APP_JSON_READ_ERR,b.ext=a.toString(),b}let z={};try{z=JSON.parse(x)}catch(b){const c=s.parseJsonParseErr({data:x,error:b});a(c,w.APP_JSON_PARSE_ERR)}'string'==l.getType(z.entryPagePath)&&b(z.entryPagePath,'entryPagePath');const A=z.pages||[];('array'!=l.getType(A)||0===A.length)&&a(m.config.ENTRANCE_NOT_FOUND.format(JSON.stringify(A)),w.APP_JSON_ENTRANCE_NOT_FOUND_ERR);let B=!z.entryPagePath;const C={};for(let c=0;c<A.length;c++){const d=A[c];b(d,`pages[${c}]`),C[d]&&a(m.config.JSON_PAGES_REPEAT.format([v,d]),w.APP_JSON_PAGES_ERR),C[d]=!0,B||d!=z.entryPagePath||(B=!0),k.existsSync(j.join(r,`${d}\.wxml`))||a(m.config.JSON_PAGE_WXML_NOT_EXISTS.format([v,'pages',d]),w.APP_JSON_WXML_NOT_FOUND),k.existsSync(j.join(r,`${d}\.js`))||a(m.config.JSON_PAGE_JS_NOT_EXISTS.format([v,'pages',d]),w.APP_JSON_JS_NOT_FOUND)}await f(i,z);const D=i.compileType;if(D==o.conversation||D==o.search){const a=z.widgets;let b,c='';if(!a)b=new Error(m.config.JSON_WIDGETS_EMPTY.format('app.json'));else if('array'!=l.getType(a))b=new Error(m.config.JSON_WIDGETS_NOT_ARRAY.format('app.json'));else{const d=[];a.forEach((a,b)=>{if('object'!=l.getType(a))d.push(m.config.JSON_WIDGETS_ITEM_NOT_OBJECT.format(['app.json',b]));else if('conversation'!=a.type&&'search'!=a.type)d.push(m.config.JSON_WIDGETS_TYPE_INVALID.format(['app.json',b,'conversation\u3001search']));else if(!a.path||'string'!=l.getType(a.path))d.push(m.config.JSON_WIDGETS_PATH_NOT_FOUND.format(['app.json',b]));else if(!k.existsSync(j.join(r,a.path)))d.push(m.config.JSON_WIDGETS_PATH_NOT_FOUND.format(['app.json',b]));else{const c=k.statSync(j.join(r,a.path));c.isDirectory()?!k.existsSync(j.join(r,a.path,'widget.js'))&&d.push(m.config.JSON_WIDGETS_JS_NOT_FOUND.format(['app.json',b,'widget.js'])):d.push(m.config.JSON_WIDGETS_PATH_SHOULD_BE_DIR.format(['app.json',b]))}c||a.type!=i.compileType||(c=a.path)}),c||d.push(m.config.JSON_WIDGETS_TYPE_NOT_FOUND.format(['app.json',i.compileType])),0<d.length&&(b=new Error(d.join('\n')))}if(b)throw b.code=w.APP_JSON_CONTENT_ERR,b}const E=await n(i);if(E)for(const a in E)'extPages'!=a&&(z[a]='object'==l.getType(E[a])?Object.assign({},z[a]||{},E[a]):E[a]);const F=d(i,r,z);return B=B||F,B||a(m.config.JSON_ENTRY_PAGE_PATH_NOT_FOUND.format(['pages\u3001subPackages','entryPagePath']),w.APP_JSON_PAGES_ERR),c(i,z),e(z),h(r,z),z.window&&(y=[],['enablePullDownRefresh'].forEach((a)=>{'undefined'!=typeof z.window[a]&&'boolean'!=typeof z.window[a]&&y.push(m.config.JSON_CONTENT_SHOULD_BE.format([a,'boolean']))}),z.window.backgroundColorTop&&(z.window.backgroundColor=z.window.backgroundColorTop)),z.usingComponents&&t.checkUsingComponents(z,{msg:y,filePath:'app.json',JSON_PARSE_ERR:w.APP_JSON_PARSE_ERR}),g(i,z),0<y.length&&a(y.join('\n'),w.APP_JSON_CONTENT_ERR),z}const j=require('path'),k=require('fs'),l=require('./84b183688a46c9e2626d3e6f83365e13.js'),m=require('./common/locales/index.js'),n=require('./551bb965e1f344281d555a429cd2140c.js'),o=require('./9fdd4ac31a05c27355910f0d74accd4c.js'),p=require('./162bf2ee28b76d3b3d95b685cede4146.js'),q=require('./2dfc6a3df6d6fc51266b293c8420e88b.js'),r=require('./56c390e04c10e91a4aa2a2c19d9a885d.js'),s=require('./6238a86bb7a55c11aa0f9eb335d0f34c.js'),t=require('./464e9598eb5c203da6b41e702e422c70.js'),u=require('./6242f55dbdfe53c2f07b7a51568311f2.js'),v=['.png','.jpg','.jpeg'],w=require('./949d8235c744ced2a80121e4dba34c28.js');module.exports=async function(a){try{return await i(a)}catch(a){throw a.code||(a.code=w.APP_JSON_CONTENT_ERR),a}}}(require('lazyload'),require);